<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>IndoorFusionNav | Winchell</title>
    <meta name="description" content="A VitePress Site">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/assets/style.CdfqIP7-.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.79BmA6Hu.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.CRHEUj4m.js">
    <link rel="modulepreload" href="/assets/chunks/framework.B5S16sG3.js">
    <link rel="modulepreload" href="/assets/algorithm_IndoorFusionNav_index.md.C4u5cByb.lean.js">
    <link rel="icon" href="https://raw.githubusercontent.com/salmoshu/Winchell-ImgBed/main/img/doghead.jpg">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/" data-v-1168a8e4><!--[--><!--]--><!--[--><img class="VPImage logo" src="https://raw.githubusercontent.com/salmoshu/Winchell-ImgBed/main/img/doghead.jpg" alt data-v-8426fc1a><!--]--><span data-v-1168a8e4>Winchell</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Home</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>GNSS</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/algorithm/MobileGNSS-SPP/" data-v-35975db6><!--[--><span data-v-35975db6>MobileGNSS-SPP</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>RTKLIB</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/algorithm/RTKLIB-Manual-CN/01-overview.html" data-v-35975db6><!--[--><span data-v-35975db6>RTKLIB-Manual-CN</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/algorithm/RTKLIB-Source-Notes/01-overview.html" data-v-35975db6><!--[--><span data-v-35975db6>RTKLIB-Source-Notes</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>Fusion</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/algorithm/KF-GINS-Py/" data-v-35975db6><!--[--><span data-v-35975db6>KF-GINS-Py</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>Indoor</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link active" href="/algorithm/IndoorFusionNav/" data-v-35975db6><!--[--><span data-v-35975db6>IndoorFusionNav</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/salmoshu" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/salmoshu" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-17a5e62e><button data-v-17a5e62e>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>目录</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _algorithm_IndoorFusionNav_" data-v-39a288b8><div><h1 id="indoorfusionnav" tabindex="-1">IndoorFusionNav <a class="header-anchor" href="#indoorfusionnav" aria-label="Permalink to &quot;IndoorFusionNav&quot;">​</a></h1><p><img src="https://raw.githubusercontent.com/salmoshu/Winchell-ImgBed/main/img/20250616-225547.jpg" alt=""></p><p><a href="https://github.com/salmoshu/IndoorFusionNav" target="_blank" rel="noreferrer"><strong>IndoorFusionNav</strong></a>是一个基于Wi-Fi/PDR（行人航位推算）的多源融合定位项目，目前包含了Wi-Fi指纹定位、PDR与EKF融合定位的Python实现，本项目针对的平台为安卓平台，融合使用的数据为Wi-Fi数据与IMU数据。</p><p>项目中涉及的Java代码主要用于采集实验数据，而数据分析与定位轨迹生成主要使用Python离线完成。该项目较为久远，在数据采集和融合时没有很好地注意不同数据源之间的时间同步问题（应当进行插值或外推）。不过这并不影响大家通过项目源码来理解Wi-Fi指纹、PDR和EKF等定位领域中的基础概念。</p><p>最后，该项目只是一个入门的科研项目，让初次涉猎该领域的同学能够快速上手。doc目录下提供了笔者的大论文，仅供参考。</p><hr><ul><li><a href="#第三方依赖">第三方依赖</a></li><li><a href="#实验数据">实验数据</a></li><li><a href="#开始使用">开始使用</a><ul><li><a href="#Demo1-PDR定位">Demo1 PDR定位</a></li><li><a href="#Demo2-Wi-Fi指纹定位">Demo2 Wi-Fi指纹定位</a></li><li><a href="#Demo3-融合定位">Demo3 融合定位</a></li></ul></li><li><a href="#数据采集程序">数据采集程序</a></li><li><a href="#历史版本">历史版本</a></li></ul><h2 id="第三方依赖" tabindex="-1">第三方依赖 <a class="header-anchor" href="#第三方依赖" aria-label="Permalink to &quot;第三方依赖&quot;">​</a></h2><ul><li>Numpy</li><li>Pandas</li><li>Matplotlib</li><li>Sklearn</li></ul><h2 id="实验数据" tabindex="-1">实验数据 <a class="header-anchor" href="#实验数据" aria-label="Permalink to &quot;实验数据&quot;">​</a></h2><table tabindex="0"><thead><tr><th style="text-align:left;"><strong>data</strong></th><th><strong>实验数据</strong></th></tr></thead><tbody><tr><td style="text-align:left;">data/count_steps</td><td>正常直线行走数据，包含了安卓或苹果设备采集的数据，用来判断步伐检测的结果是否良好，其中安卓程序为自己开发的程序，苹果数据采集程序为phyphox（使用的时候注意修改属性名，方便后续程序使用）。</td></tr><tr><td style="text-align:left;">data/fusion</td><td>小范围融合定位实验，具体数据包含了：Fingerprint（指纹数据）、LeftBorder（左边缘测试点）、RightBorder（右边缘测试点）和LType（L型路线行走数据）。</td></tr><tr><td style="text-align:left;">data/linear_08m</td><td>正常直线行走数据，行走步数为10步，每一步为固定步长0.8m。</td></tr><tr><td style="text-align:left;">data/rssi_fluctuation</td><td>一组长时间记录Wi-Fi变化的数据，每个文件大约记录2万条样本数据，该数据可以用来分析Wi-Fi数据的波动情况。</td></tr><tr><td style="text-align:left;">data/still</td><td>静止数据，用来分析惯性传感器数据的特性。</td></tr></tbody></table><h2 id="开始使用" tabindex="-1">开始使用 <a class="header-anchor" href="#开始使用" aria-label="Permalink to &quot;开始使用&quot;">​</a></h2><p>IndoorFusionNav的使用前提：操作的文件格式大概为如下所示，其中rssi根据实验过程中AP数量决定，AP为指定的固定路由器，比较适合小范围实验。</p><table tabindex="0"><thead><tr><th>timestamp</th><th>rssi1</th><th>rssi2</th><th>rssi3</th><th>rssi4</th><th>linear-x</th><th>linear-y</th><th>linear-z</th><th>gravity-x</th><th>gravity-y</th><th>gravity-z</th><th>rotation-x</th><th>rotation-y</th><th>rotation-z</th><th>rotation-w</th></tr></thead><tbody><tr><td>1591610015190</td><td>-37</td><td>-45</td><td>-66</td><td>-64</td><td>0.1322</td><td>-0.0105</td><td>0.5227</td><td>0.4463</td><td>2.8838</td><td>9.3623</td><td>0.078042</td><td>-0.12869</td><td>-0.75696</td><td>0.635895</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr></tbody></table><p>可以利用pandas读取数据，并获取为numpy.ndarray格式数据，location模块中类的参数均为numpy.ndarray格式。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rssi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df[[col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df.columns </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;rssi&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col]].values</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">linear </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df[[col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df.columns </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;linear&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col]].values</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gravity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df[[col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df.columns </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;gravity&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col]].values</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rotation </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df[[col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df.columns </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;rotation&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col]].values</span></span></code></pre></div><p>location模块提供以下功能：</p><table tabindex="0"><thead><tr><th style="text-align:left;"><strong>location</strong></th><th><strong>自定义定位工具包（可以进行数据分析与处理、定位解算与可视化，不同文件可配合使用）</strong></th></tr></thead><tbody><tr><td style="text-align:left;">location/fusion.py</td><td>融合定位工具包，包含了EKF融合定位算法。</td></tr><tr><td style="text-align:left;">locaiton/pdr.py</td><td>PDR定位工具包，包含了步伐检测、航向角推算、步长推算和定位结束输出等常见功能。</td></tr><tr><td style="text-align:left;">location/wifi.py</td><td>wifi指纹定位工具包，包含了常见的在线匹配算法。</td></tr></tbody></table><h3 id="demo1-pdr定位" tabindex="-1">Demo1 PDR定位 <a class="header-anchor" href="#demo1-pdr定位" aria-label="Permalink to &quot;Demo1 PDR定位&quot;">​</a></h3><p>要进行PDR操作，需要创建一个<code>pdr.Model</code>对象：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> location.pdr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdr</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pdr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdr.Model(linear, gravity, rotation)</span></span></code></pre></div><h4 id="demo1-1-show-steps函数-显示垂直方向合加速度与步伐波峰分布" tabindex="-1">Demo1.1 show_steps函数：显示垂直方向合加速度与步伐波峰分布 <a class="header-anchor" href="#demo1-1-show-steps函数-显示垂直方向合加速度与步伐波峰分布" aria-label="Permalink to &quot;Demo1.1 show_steps函数：显示垂直方向合加速度与步伐波峰分布&quot;">​</a></h4><p><code>show_steps</code>参数使用说明如下：</p><ul><li><strong>frequency</strong> - 数据采集频率</li><li><strong>walkType</strong> - 行走模式</li></ul><table tabindex="0"><thead><tr><th style="text-align:left;">walkType</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;">normal</td><td style="text-align:left;">正常行走模式。</td></tr><tr><td style="text-align:left;">abnormal</td><td style="text-align:left;">小范围实验行走模式。在做Wi-Fi指纹与PDR融合定位的时候，由于安卓设备Wi-Fi扫描有一定的时间间隔（大约为2~3秒），所以在实验的过程中，两步之间的控制时间大于3s，算法部分进行了不同处理。</td></tr></tbody></table><p>示例1，对data/linear_08m中的数据进行分析。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pdr.show_steps(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">frequency</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">70</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">walkType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;normal&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>结果如下：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo1_1.png" alt=""></p><p>示例2，对fusion01/SType中的数据进行分析。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pdr.show_steps(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">frequency</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">70</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">walkType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;abnormal&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>结果如下：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo1_2.png" alt=""></p><p>可以发现，对比示例1中的结果，该图峰值之间的间隔比较大。</p><h4 id="demo1-2-show-gaussian函数-查看数据在一定范围内的分布情况" tabindex="-1">Demo1.2 show_gaussian函数：查看数据在一定范围内的分布情况 <a class="header-anchor" href="#demo1-2-show-gaussian函数-查看数据在一定范围内的分布情况" aria-label="Permalink to &quot;Demo1.2 show_gaussian函数：查看数据在一定范围内的分布情况&quot;">​</a></h4><p>用来判断数据的分布情况，同时可利用高斯函数拟合（可选），可以用来分析静止惯性数据。</p><p><code>show_gaussian</code>参数使用说明如下：</p><ul><li><strong>data</strong> - 某一轴加速度数据</li><li><strong>fit</strong> - 布尔值，是否进行高斯拟合</li></ul><p>示例1，对data/still中的静止数据进行分析。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acc_z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> linear[:,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pdr.show_gaussian(acc_z, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>结果如下：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo1_3.png" alt=""></p><p>示例2，对data/linear_08m中的数据及进行分析：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acc_z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> linear[:,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pdr.show_gaussian(acc_z, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>结果如下：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo1_4.png" alt=""></p><h4 id="demo1-3-show-data函数-查看三轴加速度的分布情况" tabindex="-1">Demo1.3 show_data函数：查看三轴加速度的分布情况 <a class="header-anchor" href="#demo1-3-show-data函数-查看三轴加速度的分布情况" aria-label="Permalink to &quot;Demo1.3 show_data函数：查看三轴加速度的分布情况&quot;">​</a></h4><p><code>show_data</code>参数使用说明如下：</p><table tabindex="0"><thead><tr><th style="text-align:left;">dataType</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;">linear</td><td style="text-align:left;">查看三轴线性加速度的分布情况</td></tr><tr><td style="text-align:left;">gravity</td><td style="text-align:left;">查看三轴重力加速度的分布情况</td></tr><tr><td style="text-align:left;">rotation</td><td style="text-align:left;">查看旋转四元数的数据分布情况</td></tr></tbody></table><p>示例1，对data/linear_08m中的数据及行分析：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pdr.show_data(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;linear&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>结果如下：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo1_5.png" alt=""></p><p>示例2，对data/linear_08m中的数据及行分析：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pdr.show_data(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;gravity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>结果如下：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo1_6.png" alt=""></p><p>示例3，对data/linear_08m中的数据及行分析：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pdr.show_data(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;rotation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>结果如下：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo1_7.png" alt=""></p><h4 id="demo1-4-step-stride函数-步长推算函数" tabindex="-1">Demo1.4 step_stride函数：步长推算函数 <a class="header-anchor" href="#demo1-4-step-stride函数-步长推算函数" aria-label="Permalink to &quot;Demo1.4 step_stride函数：步长推算函数&quot;">​</a></h4><p><code>step_stride</code>传入的是某一时刻的函数值，往往是垂直方向合加速度的峰值点，从而推算出步长值。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">stride_length </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdr.step_stride(acc)</span></span></code></pre></div><h4 id="demo1-5-step-counter函数-获取数据中的步伐信息" tabindex="-1">Demo1.5 step_counter函数：获取数据中的步伐信息 <a class="header-anchor" href="#demo1-5-step-counter函数-获取数据中的步伐信息" aria-label="Permalink to &quot;Demo1.5 step_counter函数：获取数据中的步伐信息&quot;">​</a></h4><p><code>step_counter</code>会返回一个包含每一个步伐信息的字典类型数组，其中index为样本序号，acceleration为步伐加速度峰值，函数参数使用说明如下：</p><ul><li><strong>frequency</strong> - 数据采集频率</li><li><strong>walkType</strong> - 行走模式</li></ul><table tabindex="0"><thead><tr><th style="text-align:left;">walkType</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;">normal</td><td style="text-align:left;">正常行走模式。</td></tr><tr><td style="text-align:left;">abnormal</td><td style="text-align:left;">实验行走模式。在做Wi-Fi指纹与PDR融合定位的时候，由于安卓设备Wi-Fi扫描有一定的时间间隔，所以在实验的过程中，两步之间的控制时间大于3s，所以算法部分进行了不同处理。</td></tr></tbody></table><p>示例1，对data/linear_08m中的数据进行分析。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pdr.show_steps(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">frequency</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">70</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">walkType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;normal&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(steps)</span></span></code></pre></div><p>结果如下：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &#39;index&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">298</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &#39;acceleration&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.88391844277864</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &#39;index&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">354</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &#39;acceleration&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6.163800299609754</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    ......</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><p>示例2，利用data/linear_08m中的数据分析步长推算算法的准确度：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">steps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdr.step_counter(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">frequency</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">70</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">walkType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;normal&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;steps:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(steps))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">stride </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdr.step_stride</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">accuracy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> steps:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;acceleration&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stride(a))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    accuracy.append(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        np.abs(stride(a)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">square_sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> accuracy:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    square_sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acc_mean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (square_sum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(steps))</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mean: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> %</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> acc_mean) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 平均误差</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;min: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> %</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.min(accuracy)) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 最小误差</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;max: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> %</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.max(accuracy)) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 最大误差</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sum: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> %</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.sum(accuracy)) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 累积误差</span></span></code></pre></div><p>结果如下：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">steps:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0.7019198589090117</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0.7878293284920566</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0.8188530449804803</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0.7910022847592212</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0.7700272110821945</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0.7766284915404985</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0.8636455533175651</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0.7555013698705025</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0.8041832313898543</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0.8379454829417488</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mean:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.043746</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">min:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.004183</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">max:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.098080</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sum:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.341719</span></span></code></pre></div><h4 id="demo1-6-step-heading函数-步长推算函数" tabindex="-1">Demo1.6 step_heading函数：步长推算函数 <a class="header-anchor" href="#demo1-6-step-heading函数-步长推算函数" aria-label="Permalink to &quot;Demo1.6 step_heading函数：步长推算函数&quot;">​</a></h4><p>实验过程中手机采用HOLDING模式，即手握手机放在胸前，并且x轴与地面平行，<code>step_heading</code>直接返回每一时刻的偏航角yaw值，初始值默认设为0，这里的都是相对值。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">yaw </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdr.step_heading()</span></span></code></pre></div><h4 id="demo1-7-pdr-position函数-获取数据中的步伐信息" tabindex="-1">Demo1.7 pdr_position函数：获取数据中的步伐信息 <a class="header-anchor" href="#demo1-7-pdr-position函数-获取数据中的步伐信息" aria-label="Permalink to &quot;Demo1.7 pdr_position函数：获取数据中的步伐信息&quot;">​</a></h4><p><code>pdr_position</code>会返回每一步的x、y坐标值，以及每一步的步长和航向角：</p><ul><li><strong>frequency</strong> - 数据采集频率</li><li><strong>walkType</strong> - 行走模式</li><li><strong>offset</strong> - 初始航向角大小</li><li><strong>initPosition</strong> - 初始位置，格式为两个元素的元组形式，分别表示x与y</li></ul><table tabindex="0"><thead><tr><th style="text-align:left;">walkType</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;">normal</td><td style="text-align:left;">正常行走模式。</td></tr><tr><td style="text-align:left;">fusion</td><td style="text-align:left;">实验行走模式。在做Wi-Fi指纹与PDR融合定位的时候，由于安卓设备Wi-Fi扫描有一定的时间间隔，所以在实验的过程中，两步之间的控制时间大于3s，所以算法部分进行了不同处理。</td></tr></tbody></table><p>示例：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">position_x, position_y, strides, angle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdr.show_steps(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">frequency</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">70</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">walkType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;abnormal&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">， </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">np.pi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">initPosition</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><h4 id="demo1-8-show-trace函数-输出行走轨迹图" tabindex="-1">Demo1.8 show_trace函数：输出行走轨迹图 <a class="header-anchor" href="#demo1-8-show-trace函数-输出行走轨迹图" aria-label="Permalink to &quot;Demo1.8 show_trace函数：输出行走轨迹图&quot;">​</a></h4><p><code>show_trace</code>内部使用了<code>pdr_position</code>，可以输出轨迹图像。</p><ul><li><strong>frequency</strong> - 数据采集频率</li><li><strong>walkType</strong> - 行走模式</li><li><strong>offset</strong> - 轨迹偏差角度（指上北下南地图中的轨迹旋转到输出轨迹的角度值，实验过程使用了安卓的旋转矢量软件传感器，它集成了加速度计、陀螺仪和磁力计的数据，最终输出了一个以地球坐标系为基础的绝对信息，但实验输出图有时候会分析一个相对定位的情景，所以可以用该偏差值进行修正）</li><li><strong>initPosition</strong> - 初始位置，格式为两个元素的元组形式，分别表示x与y</li><li><strong>realTrace</strong> - 两列的numpy.ndarray格式数据，表示真实轨迹坐标，主要是为了方便轨迹的对比（可选）</li></ul><table tabindex="0"><thead><tr><th style="text-align:left;">walkType</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;">normal</td><td style="text-align:left;">正常行走模式。</td></tr><tr><td style="text-align:left;">abnormal</td><td style="text-align:left;">小范围实验行走模式。在做Wi-Fi指纹与PDR融合定位的时候，由于安卓设备Wi-Fi扫描有一定的时间间隔，所以在实验的过程中，两步之间的控制时间大于3s，所以算法部分进行了不同处理。</td></tr></tbody></table><p>示例1，显示data/fusion/LType数据的预测轨迹图：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pdr.show_trace(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">frequency</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">70</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">walkType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;abnormal&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">initPosition</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><p>结果如下：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo1_8.png" alt=""></p><p>示例2，显示data/fusion/LType数据的预测轨迹图：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pdr.show_trace(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">frequency</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">70</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">walkType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;abnormal&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">real_trace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">real_trace, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">initPosition</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><p>结果如下：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo1_9.png" alt=""></p><h3 id="demo2-wi-fi指纹定位" tabindex="-1">Demo2 Wi-Fi指纹定位 <a class="header-anchor" href="#demo2-wi-fi指纹定位" aria-label="Permalink to &quot;Demo2 Wi-Fi指纹定位&quot;">​</a></h3><p>要进行wifi操作，需要创建一个<code>wifi.Model</code>对象，由于实验数据中是以每一步作为一个定位状态，因此这里<code>pdr</code>与<code>wifi</code>配合使用。从代码层面而言这不是必要的，也可以更换成其他业务。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> location.wifi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wifi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wifi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wifi.Model(rssi)</span></span></code></pre></div><h4 id="demo2-1-rssi-fluctuation函数-查看wifi数据的波动情况" tabindex="-1">Demo2.1 rssi_fluctuation函数：查看wifi数据的波动情况 <a class="header-anchor" href="#demo2-1-rssi-fluctuation函数-查看wifi数据的波动情况" aria-label="Permalink to &quot;Demo2.1 rssi_fluctuation函数：查看wifi数据的波动情况&quot;">​</a></h4><p><code>rssi_fluctuation</code>需要传入一个布尔值merge作为参数。</p><table tabindex="0"><thead><tr><th style="text-align:left;">merge</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;">True</td><td style="text-align:left;">以Wi-Fi扫描次数作为x轴</td></tr><tr><td style="text-align:left;">False</td><td style="text-align:left;">以样本点数目作为x轴，事实上样本点数目合并一个Wi-Fi扫描间隔数据从而得到了合并的效果。</td></tr></tbody></table><p>示例1，显示data/rssi_fluctuation数据：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wifi.rssi_fluctuation(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>结果如下：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo2_1.png" alt=""></p><p>示例2，显示data/rssi_fluctuation数据：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wifi.rssi_fluctuation(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>结果如下：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo2_2.png" alt=""></p><h4 id="demo2-2-determinegaussian函数-查看wifi数据的高斯拟合情况" tabindex="-1">Demo2.2 determineGaussian函数：查看wifi数据的高斯拟合情况 <a class="header-anchor" href="#demo2-2-determinegaussian函数-查看wifi数据的高斯拟合情况" aria-label="Permalink to &quot;Demo2.2 determineGaussian函数：查看wifi数据的高斯拟合情况&quot;">​</a></h4><p><code>determineGaussian</code>的参数如下所示：</p><ul><li><strong>data</strong>- numpy.ndarray格式数据，源自一个AP的wifi信号强度数据</li><li><strong>merge</strong>- 是否合并为每一个扫描次数</li><li><strong>interval</strong>- 划分间隔，默认值为1</li><li><strong>wipeRange</strong>- 剔除样本点数目</li></ul><p>示例1，显示data/rssi_fluctuation数据：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wifi.determineGaussian(rssi[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">wipeRange</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">170</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>结果如下：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo2_3.png" alt=""></p><h4 id="demo2-3-create-fingerpirnt函数-构建一个指纹库" tabindex="-1">Demo2.3 create_fingerpirnt函数：构建一个指纹库 <a class="header-anchor" href="#demo2-3-create-fingerpirnt函数-构建一个指纹库" aria-label="Permalink to &quot;Demo2.3 create_fingerpirnt函数：构建一个指纹库&quot;">​</a></h4><p><code>create_fingerpint</code>返回一个指纹数据均值与其对应的坐标，传入的参数为所有采集好的指纹数据的文件目录，对文件命名的要求是：需要按照<code>x-y.csv</code>的方式对文件命名，比如坐标是<code>(0,0)</code>，则文件名为<code>0-0.csv</code>。</p><p>示例1，对于指纹库data/fusion01/Fingerpint：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rssi, position </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wifi.create_fingerprint(fingerprint_path)</span></span></code></pre></div><p><code>rssi</code>和<code>position</code>可以直接带入sklearn的机器学习算法中进行训练。</p><h4 id="demo2-4-在线匹配算法" tabindex="-1">Demo2.4 在线匹配算法 <a class="header-anchor" href="#demo2-4-在线匹配算法" aria-label="Permalink to &quot;Demo2.4 在线匹配算法&quot;">​</a></h4><p>这一部分仅作为参考，可以参考<a href="https://www.cnblogs.com/rubbninja/p/6186847.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/rubbninja/p/6186847.html</a> ，建议大家能够用更优的算法到这一部分。为了我自己操作方便，wifi模块在sklearn的基础上对一些常见的在线匹配算法进行了简单的封装，常见的算法与其模如下：</p><table tabindex="0"><thead><tr><th>方法</th><th>算法</th></tr></thead><tbody><tr><td>wifi.knn_reg</td><td>knn</td></tr><tr><td>wifi.svm_reg</td><td>support vector machine</td></tr><tr><td>wifi.rf_reg</td><td>random forest</td></tr><tr><td>wifi.dbdt</td><td>Gradient Boosting for regression</td></tr><tr><td>wifi.nn</td><td>Multi-layer Perceptron regressor</td></tr></tbody></table><p>示例1，对于数据data/fusion/LType，如果使用knn：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pdr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdr.Model(linear, gravity, rotation)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wifi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wifi.Model(rssi)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 真实轨迹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">real_trace </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(real_trace_file).values</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 指纹数据（作为离线数据）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fingerprint_rssi, fingerprint_position </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wifi.create_fingerprint(fingerprint_path)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 找到峰值出的rssi值（作为在线匹配数据）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">steps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdr.step_counter(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">frequency</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">70</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">walkType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;fusion&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;steps:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(steps))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fingerprint_rssi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].reshape(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k, v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(steps):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    index </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;index&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rssi[index]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value.reshape(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.concatenate((result,value),</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">axis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># knn算法</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">predict, accuracy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wifi.knn_reg(fingerprint_rssi, fingerprint_position, result, real_trace)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;knn accuracy:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, accuracy, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;m&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>经过上述操作可以得到预测坐标序列和误差均值。</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">knn accuracy: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.93</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> m</span></span></code></pre></div><p>其他算法类似。</p><h4 id="demo2-5-show-trace函数-生成wifi指纹定位轨迹" tabindex="-1">Demo2.5 show_trace函数：生成wifi指纹定位轨迹 <a class="header-anchor" href="#demo2-5-show-trace函数-生成wifi指纹定位轨迹" aria-label="Permalink to &quot;Demo2.5 show_trace函数：生成wifi指纹定位轨迹&quot;">​</a></h4><p><code>show_trace</code>传入预测坐标序列和真实轨迹（可选）。</p><p>示例1，对于数据data/fusion/LType：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wifi.show_trace(predict, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">real_trace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">real_trace)</span></span></code></pre></div><p>结果如下：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo2_4.png" alt=""></p><p>由于wifi数据的波动非常大，因此结果会有些难看。</p><h3 id="demo3-融合定位" tabindex="-1">Demo3 融合定位 <a class="header-anchor" href="#demo3-融合定位" aria-label="Permalink to &quot;Demo3 融合定位&quot;">​</a></h3><p>要进行fusion操作，需要创建一个<code>fusion.Model</code>对象，配合<code>pdr</code>与<code>wifi</code>一起使用。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> location.fusion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fusion</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fusion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fusion.Model()</span></span></code></pre></div><p>目前fusion中只有ekf算法，为<code>ekf2d</code>函数，返回融合的状态列向量的数组，参数列表如下：</p><table tabindex="0"><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>transition_states</td><td>状态转移序列</td></tr><tr><td>observation_states</td><td>观测值序列</td></tr><tr><td>transition_func</td><td>状态转移函数</td></tr><tr><td>jacobF_func</td><td>状态转移矩阵的一阶线性函数</td></tr><tr><td>initial_state_covariance</td><td>初始状态协方差</td></tr><tr><td>observation_matrices</td><td>观测矩阵</td></tr><tr><td>transition_covariance</td><td>状态转移协方差</td></tr><tr><td>observation_covariance</td><td>观测协方差</td></tr></tbody></table><p>示例1，对于数据data/fusion/LType：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 已知数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">angle </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 航向角序列</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">L </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 步长序列</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sigma_wifi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sigma_pdr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> .2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sigma_yaw </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">360</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">L </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 步长序列</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 状态转移函数（参入包含所有状态参数的数组）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> state_conv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(parameters_arr):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> parameters_arr[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> parameters_arr[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    theta </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> parameters_arr[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">np.sin(theta), y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">L[i]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">np.cos(theta), angle[i] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 伪代码i表示第i个状态</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.matrix([[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]])</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 观测矩阵</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">H </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.matrix([[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]])</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 状态转移协方差矩阵</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Q </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.matrix([[sigma_pdr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, sigma_pdr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, sigma_yaw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]])</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 观测噪声方差</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">R </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.matrix([[sigma_wifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, sigma_wifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, sigma_yaw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> jacobF_func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.matrix([[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, L[i]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">np.cos(angle[i])],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                      [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">L[i]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">np.sin(angle[i])],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                      [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">S </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fusion.ekf2d(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    transition_states</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> transition_states</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   ,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">observation_states</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> observation_states</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   ,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">transition_func</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> state_conv</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   ,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">jacobF_func</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jacobF_func</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   ,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">initial_state_covariance</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> P</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   ,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">observation_matrices</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> H</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   ,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">transition_covariance</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Q</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   ,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">observation_covariance</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> R</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X_ekf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Y_ekf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> S:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    X_ekf.append(v[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Y_ekf.append(v[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre></div><p>对所有轨迹数据进行可视化：</p><p><img src="https://github.com/salmoshu/IndoorFusionNav/raw/master/image/Demo3_1.png" alt=""></p><h2 id="数据采集程序" tabindex="-1">数据采集程序 <a class="header-anchor" href="#数据采集程序" aria-label="Permalink to &quot;数据采集程序&quot;">​</a></h2><p>开发安卓数据采集程序这一部分如果想了解更多，请参考我的<a href="https://blog.csdn.net/qq_28675933/article/details/103668811" target="_blank" rel="noreferrer">CSDN博客</a>。</p><h3 id="step-1-安装android-studio" tabindex="-1">Step 1 安装Android Studio <a class="header-anchor" href="#step-1-安装android-studio" aria-label="Permalink to &quot;Step 1 安装Android Studio&quot;">​</a></h3><p>从安卓官网上下载并安装安卓开发工具：<a href="https://developer.android.com/studio%E3%80%82" target="_blank" rel="noreferrer">https://developer.android.com/studio。</a></p><h3 id="step-2-新建项目并替换掉相关文件" tabindex="-1">Step 2 新建项目并替换掉相关文件 <a class="header-anchor" href="#step-2-新建项目并替换掉相关文件" aria-label="Permalink to &quot;Step 2 新建项目并替换掉相关文件&quot;">​</a></h3><p>使用Android Studio新建一个空项目以后，用android中的文件替换掉空项目中的文件，替换的时候注意修改第一行的包名。</p><table tabindex="0"><thead><tr><th style="text-align:left;"><strong>android</strong></th><th><strong>数据采集程序</strong></th></tr></thead><tbody><tr><td style="text-align:left;">activity_main.xml</td><td>替换位置：项目目录\程序名\app\src\main\res\layout</td></tr><tr><td style="text-align:left;">AndroidManifest.xml</td><td>替换位置：项目目录\程序名\app\src\main</td></tr><tr><td style="text-align:left;">FileUtil.java</td><td>替换位置：项目目录\程序名\app\src\main\java\com\example\data</td></tr><tr><td style="text-align:left;">LogUtil.java</td><td>替换位置：项目目录\程序名\app\src\main\java\com\example\data</td></tr><tr><td style="text-align:left;">MainActivity.java</td><td>替换位置：项目目录\程序名\app\src\main\java\com\example\data</td></tr><tr><td style="text-align:left;">WifiUtil.java</td><td>替换位置：项目目录\程序名\app\src\main\java\com\example\data</td></tr></tbody></table><h3 id="step-3-修改文件代码参数" tabindex="-1">Step 3 修改文件代码参数 <a class="header-anchor" href="#step-3-修改文件代码参数" aria-label="Permalink to &quot;Step 3 修改文件代码参数&quot;">​</a></h3><p>做与WiFi相关的实验时，一般都是使用固定好的路由器，路由器的MAC或者SSID已知，因此需要修改MainActivity.java文件中路由器参数，方便做后续实验。需要修改的参数为<code>levelArray</code>、<code>apNames</code>、<code>rssis</code>，现在假设实验的路由器SSID分别为<code>router-01</code>、<code>router-02</code>、<code>router-03</code>、<code>router-04</code>，则需要修改为如下所示：</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">package</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> com.example.yourappname;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// import ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MainActivity</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AppCompatActivity</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SensorEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 配置路由器参数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] levelArray </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] apNames </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[]{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;router-01&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;router-02&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;router-03&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;router-04&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String rssis </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;rssi1,rssi2,rssi3,rssi4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...</span></span></code></pre></div><p>其中<code>rssis</code>必须命名为<code>&quot;rssi&quot;</code>的形式。</p><h3 id="step-4-采集数据并导出" tabindex="-1">Step 4 采集数据并导出 <a class="header-anchor" href="#step-4-采集数据并导出" aria-label="Permalink to &quot;Step 4 采集数据并导出&quot;">​</a></h3><p>使用程序的时候，注意给程序“存储”与“位置”权限，对于采集好的数据，使用adb工具导出，adb工具在Android Studio安装好并且完成初始化之后就捆绑安装。为了方便操作，在环境变量里面配置了adb，这样方便全局操作，adb工具的位置一般在<code>C:\Users\username\AppData\Local\Android\Sdk\platform-tools</code>，一次实例操作如下所示。</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PS C:\user\salmo\Desktop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> adb shell</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HWFRD:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $ su</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HWFRD:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # cp -R /data/data/com.example.data2 /sdcard/documents</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HWFRD:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # exit</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HWFRD:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">exit</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PS C:\Users\salmo\Desktop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> adb pull </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sdcard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">documents</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sdcard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">documents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> files pulled</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> skipped. </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4.7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MB</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">478123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bytes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">096s)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PS C:\Users\salmo\Desktop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><p>由于权限问题，数据先导出到sd卡中，再由sd卡导出到电脑里面，整个过程不算太容易，欢迎大家自寻更好的数据导出方法。</p><h3 id="step-5-数据文件" tabindex="-1">Step 5 数据文件 <a class="header-anchor" href="#step-5-数据文件" aria-label="Permalink to &quot;Step 5 数据文件&quot;">​</a></h3><p>一个使用该程序采集的数据文件大概长这个样子：</p><table tabindex="0"><thead><tr><th>timestamp</th><th>rssi1</th><th>rssi2</th><th>rssi3</th><th>rssi4</th><th>linear-x</th><th>linear-y</th><th>linear-z</th><th>gravity-x</th><th>gravity-y</th><th>gravity-z</th><th>rotation-x</th><th>rotation-y</th><th>rotation-z</th><th>rotation-w</th></tr></thead><tbody><tr><td>1591610015190</td><td>-37</td><td>-45</td><td>-66</td><td>-64</td><td>0.1322</td><td>-0.0105</td><td>0.5227</td><td>0.4463</td><td>2.8838</td><td>9.3623</td><td>0.078042</td><td>-0.12869</td><td>-0.75696</td><td>0.635895</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr></tbody></table><h2 id="历史版本" tabindex="-1">历史版本 <a class="header-anchor" href="#历史版本" aria-label="Permalink to &quot;历史版本&quot;">​</a></h2><ol><li><p><a href="https://github.com/salmoshu/IndoorFusionNav/tree/207761d6d4e62300dd5a74074e8ace3996b455e9" target="_blank" rel="noreferrer">初始提交版本V1.0</a></p><p>实现了融合定位的基础功能，留作自己备份，建议读者使用最新版本。</p></li></ol><h2 id="许可证" tabindex="-1">许可证 <a class="header-anchor" href="#许可证" aria-label="Permalink to &quot;许可证&quot;">​</a></h2><p>IndoorFusionNav 采用 <a href="https://github.com/salmoshu/IndoorFusionNav/blob/master/LICENSE" target="_blank" rel="noreferrer">MIT 许可证</a>。详情见 <code>LICENSE</code> 文件。</p><div class="giscus"></div></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about.md\":\"DuzN6EfT\",\"algorithm_indoorfusionnav_index.md\":\"C4u5cByb\",\"algorithm_kf-gins-py_index.md\":\"BRrd0rnE\",\"algorithm_mobilegnss-spp_01-overview.md\":\"CYbnccfY\",\"algorithm_mobilegnss-spp_02-data_analysis.md\":\"CgLnpzuV\",\"algorithm_mobilegnss-spp_03-rwls.md\":\"BZ9LfX2A\",\"algorithm_mobilegnss-spp_04-ekf.md\":\"CAEgQVDf\",\"algorithm_mobilegnss-spp_05-mincost.md\":\"C0WBc0aa\",\"algorithm_mobilegnss-spp_06-appendix.md\":\"D-Aahn9T\",\"algorithm_mobilegnss-spp_07-reference.md\":\"CYHkcNQb\",\"algorithm_mobilegnss-spp_index.md\":\"CgiZKw_O\",\"algorithm_rtklib-manual-cn_01-overview.md\":\"B2Qa6yLU\",\"algorithm_rtklib-manual-cn_02-prepare.md\":\"wtNoF32S\",\"algorithm_rtklib-manual-cn_03-instructions-3.1.md\":\"BgyfrwVP\",\"algorithm_rtklib-manual-cn_03-instructions-3.10.md\":\"BD6xFWnK\",\"algorithm_rtklib-manual-cn_03-instructions-3.11.md\":\"Di_gCZ4t\",\"algorithm_rtklib-manual-cn_03-instructions-3.2.md\":\"B4BUqwPj\",\"algorithm_rtklib-manual-cn_03-instructions-3.3.md\":\"xIa-pzq7\",\"algorithm_rtklib-manual-cn_03-instructions-3.4.md\":\"BtQEMY2T\",\"algorithm_rtklib-manual-cn_03-instructions-3.5.md\":\"rB0Spy1N\",\"algorithm_rtklib-manual-cn_03-instructions-3.6.md\":\"3Eh6n7_E\",\"algorithm_rtklib-manual-cn_03-instructions-3.7.md\":\"Wlg-H-fC\",\"algorithm_rtklib-manual-cn_03-instructions-3.8.md\":\"CMK5p6tF\",\"algorithm_rtklib-manual-cn_03-instructions-3.9.md\":\"CmZ68ppT\",\"algorithm_rtklib-manual-cn_04-build.md\":\"3ROzj_ch\",\"algorithm_rtklib-manual-cn_05-appendixa.md\":\"CJZxXftk\",\"algorithm_rtklib-manual-cn_06-appendixb.md\":\"Cvk0WM4i\",\"algorithm_rtklib-manual-cn_07-appendixc.md\":\"CpofTjZ5\",\"algorithm_rtklib-manual-cn_08-appendixd.md\":\"DP9IOZTK\",\"algorithm_rtklib-manual-cn_09-appendixe-e.0.md\":\"2SndLUAN\",\"algorithm_rtklib-manual-cn_09-appendixe-e.1.md\":\"Djd1JGlv\",\"algorithm_rtklib-manual-cn_09-appendixe-e.2.md\":\"DfCPMma_\",\"algorithm_rtklib-manual-cn_09-appendixe-e.3.md\":\"onhhevNU\",\"algorithm_rtklib-manual-cn_09-appendixe-e.4.md\":\"BjIWlcis\",\"algorithm_rtklib-manual-cn_09-appendixe-e.5.md\":\"CWClwvCj\",\"algorithm_rtklib-manual-cn_09-appendixe-e.6.md\":\"BUkHuSQb\",\"algorithm_rtklib-manual-cn_09-appendixe-e.7.md\":\"kACP1DJg\",\"algorithm_rtklib-manual-cn_09-appendixe-e.8.md\":\"BLRjExE5\",\"algorithm_rtklib-manual-cn_10-appendixf.md\":\"DRXmj_a6\",\"algorithm_rtklib-manual-cn_11-appendixg.md\":\"DNHoiuio\",\"algorithm_rtklib-manual-cn_12-appendixh.md\":\"Cyi3jrpH\",\"algorithm_rtklib-manual-cn_13-reference.md\":\"64MbtsRV\",\"algorithm_rtklib-manual-cn_index.md\":\"Dn598RpX\",\"algorithm_rtklib-source-notes_01-overview-1.1.md\":\"BcdlL-Vv\",\"algorithm_rtklib-source-notes_01-overview-1.2.md\":\"PpY0xqHt\",\"algorithm_rtklib-source-notes_01-overview-1.3.md\":\"D--XFgVR\",\"algorithm_rtklib-source-notes_01-overview-1.4.md\":\"DpvGMdQn\",\"algorithm_rtklib-source-notes_01-overview-1.5.md\":\"BtSP1HLP\",\"algorithm_rtklib-source-notes_01-overview-1.6.md\":\"iEB50j92\",\"algorithm_rtklib-source-notes_01-overview.md\":\"CHmailDK\",\"algorithm_rtklib-source-notes_02-rtknavi-rtkrcv.md\":\"Coa_u_U6\",\"algorithm_rtklib-source-notes_03-rtkpos-rnx2rtkp-rtkplot-rtkget.md\":\"D_1xIBkk\",\"algorithm_rtklib-source-notes_04-rtkcmn.md\":\"BOHFUPId\",\"algorithm_rtklib-source-notes_05-obs.md\":\"DlVJC4af\",\"algorithm_rtklib-source-notes_06-eph.md\":\"CFd77jOh\",\"algorithm_rtklib-source-notes_07-obs-correction.md\":\"BsAqg9ET\",\"algorithm_rtklib-source-notes_08-spp-8.1.md\":\"85SEBXvQ\",\"algorithm_rtklib-source-notes_08-spp-8.2.md\":\"Bj_ioNIa\",\"algorithm_rtklib-source-notes_08-spp-8.3.md\":\"Cr4CV77V\",\"algorithm_rtklib-source-notes_08-spp-8.4.md\":\"BWhJfCy1\",\"algorithm_rtklib-source-notes_08-spp.md\":\"B0aQosyM\",\"algorithm_rtklib-source-notes_09-rtk-9.1.md\":\"Mu5tWjPY\",\"algorithm_rtklib-source-notes_09-rtk-9.2.md\":\"YbVo8Xpv\",\"algorithm_rtklib-source-notes_09-rtk-9.3.md\":\"DXfsXekI\",\"algorithm_rtklib-source-notes_09-rtk-9.4.md\":\"Dc4SZR-J\",\"algorithm_rtklib-source-notes_09-rtk-9.5.md\":\"BL0mqjm1\",\"algorithm_rtklib-source-notes_09-rtk-9.6.md\":\"DKgpGfjd\",\"algorithm_rtklib-source-notes_09-rtk-9.7.md\":\"CZjGDtr-\",\"algorithm_rtklib-source-notes_09-rtk.md\":\"Cx3VoVik\",\"algorithm_rtklib-source-notes_10-ppp.md\":\"62wTOKIn\",\"algorithm_rtklib-source-notes_11-optimization.md\":\"VCfY-IQk\",\"algorithm_rtklib-source-notes_a-appendixa.md\":\"CVI3Dn53\",\"algorithm_rtklib-source-notes_b-appendixb.md\":\"CQxYJ2_t\",\"algorithm_rtklib-source-notes_c-appendixc-c.1.md\":\"CReFLCrN\",\"algorithm_rtklib-source-notes_c-appendixc-c.2.md\":\"B3wARUnK\",\"algorithm_rtklib-source-notes_c-appendixc-c.3.md\":\"Chvq64H9\",\"algorithm_rtklib-source-notes_c-appendixc.md\":\"CcV8N0uK\",\"algorithm_rtklib-source-notes_copy.md\":\"L8YetPhU\",\"algorithm_rtklib-source-notes_index.md\":\"DR-CZ1zY\",\"algorithm_rtklib-source-notes_z-reference.md\":\"CqWi8Z3j\",\"contribution.md\":\"DDqqIlny\",\"hide_coding_cpp-style_01-google.md\":\"PwhIQMzh\",\"hide_coding_cpp-style_02-huawei.md\":\"C6Havrsn\",\"hide_coding_cpp-style_03-myself.md\":\"DGbQj1-I\",\"hide_examples_api-examples.md\":\"DJtk52o0\",\"hide_examples_markdown-examples.md\":\"BVTqCYDl\",\"hide_index.md\":\"B9t7wH8U\",\"hide_knowledge_01-common.md\":\"CNG6lZIW\",\"hide_tools_git_01-tutorials.md\":\"CtAuipCY\",\"hide_tools_git_readme.md\":\"BBKXBl8K\",\"hide_tools_readme.md\":\"C-7VCDOT\",\"hide_tools_vitepress_01-tutorials.md\":\"BY1R2NPN\",\"hide_tools_vitepress_02-issues.md\":\"o470OhYo\",\"hide_tools_vitepress_readme.md\":\"oK8rfuZ8\",\"index.md\":\"C7Brtuyg\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Winchell\",\"description\":\"A VitePress Site\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"https://raw.githubusercontent.com/salmoshu/Winchell-ImgBed/main/img/doghead.jpg\",\"search\":{\"provider\":\"local\"},\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"GNSS\",\"items\":[{\"text\":\"MobileGNSS-SPP\",\"link\":\"/algorithm/MobileGNSS-SPP/\"},{\"text\":\"RTKLIB\",\"items\":[{\"text\":\"RTKLIB-Manual-CN\",\"link\":\"/algorithm/RTKLIB-Manual-CN/01-overview\"},{\"text\":\"RTKLIB-Source-Notes\",\"link\":\"/algorithm/RTKLIB-Source-Notes/01-overview\"}]}]},{\"text\":\"Fusion\",\"items\":[{\"text\":\"KF-GINS-Py\",\"link\":\"/algorithm/KF-GINS-Py/\"}]},{\"text\":\"Indoor\",\"items\":[{\"text\":\"IndoorFusionNav\",\"link\":\"/algorithm/IndoorFusionNav/\"}]}],\"sidebar\":{\"/algorithm/MobileGNSS-SPP/\":[{\"text\":\"MobileGNSS-SPP\",\"link\":\"/algorithm/MobileGNSS-SPP/\"},{\"text\":\"1. 摘要\",\"link\":\"/algorithm/MobileGNSS-SPP/01-overview\"},{\"text\":\"2. 数据分析\",\"link\":\"/algorithm/MobileGNSS-SPP/02-data_analysis\"},{\"text\":\"3. RWLS\",\"link\":\"/algorithm/MobileGNSS-SPP/03-rwls\"},{\"text\":\"4. EKF\",\"link\":\"/algorithm/MobileGNSS-SPP/04-ekf\"},{\"text\":\"5. 代价最小化\",\"link\":\"/algorithm/MobileGNSS-SPP/05-mincost\"},{\"text\":\"附录\",\"link\":\"/algorithm/MobileGNSS-SPP/06-appendix\"},{\"text\":\"参考资料\",\"link\":\"/algorithm/MobileGNSS-SPP/07-reference\"}],\"/algorithm/RTKLIB-Manual-CN/\":[{\"text\":\"RTKLIB-Manual-CN\",\"link\":\"\"},{\"text\":\"1. 简介\",\"link\":\"/algorithm/RTKLIB-Manual-CN/01-overview\"},{\"text\":\"2. 准备\",\"link\":\"/algorithm/RTKLIB-Manual-CN/02-prepare\"},{\"text\":\"3. 操作指南\",\"collapsed\":true,\"items\":[{\"text\":\"3.1 下载与使用\",\"link\":\"/algorithm/RTKLIB-Manual-CN/03-instructions-3.1\"},{\"text\":\"3.2 RTKNAVI：实时定位程序\",\"link\":\"/algorithm/RTKLIB-Manual-CN/03-instructions-3.2\"},{\"text\":\"3.3 STRSVR：数据流处理\",\"link\":\"/algorithm/RTKLIB-Manual-CN/03-instructions-3.3\"},{\"text\":\"3.4 RTKPOST：后处理分析\",\"link\":\"/algorithm/RTKLIB-Manual-CN/03-instructions-3.4\"},{\"text\":\"3.5 RTKLIB 配置参数\",\"link\":\"/algorithm/RTKLIB-Manual-CN/03-instructions-3.5\"},{\"text\":\"3.6 RTKCONV：数据格式转换\",\"link\":\"/algorithm/RTKLIB-Manual-CN/03-instructions-3.6\"},{\"text\":\"3.7 RTKPLOT：解算结果可视化\",\"link\":\"/algorithm/RTKLIB-Manual-CN/03-instructions-3.7\"},{\"text\":\"3.8 RTKPLOT：观测数据可视化\",\"link\":\"/algorithm/RTKLIB-Manual-CN/03-instructions-3.8\"},{\"text\":\"3.9 RTKGET：GNSS产品和数据下载\",\"link\":\"/algorithm/RTKLIB-Manual-CN/03-instructions-3.9\"},{\"text\":\"3.10 SRCTBLBROWS：NTRIP资源列表\",\"link\":\"/algorithm/RTKLIB-Manual-CN/03-instructions-3.10\"},{\"text\":\"3.11 RTKLIB CUI程序\",\"link\":\"/algorithm/RTKLIB-Manual-CN/03-instructions-3.11\"}]},{\"text\":\"4. 应用构建\",\"link\":\"/algorithm/RTKLIB-Manual-CN/04-build\"},{\"text\":\"附录A. CUI指令\",\"link\":\"/algorithm/RTKLIB-Manual-CN/05-appendixA\"},{\"text\":\"附录B. 文件格式\",\"link\":\"/algorithm/RTKLIB-Manual-CN/06-appendixB\"},{\"text\":\"附录C. C API\",\"link\":\"/algorithm/RTKLIB-Manual-CN/07-appendixC\"},{\"text\":\"附录D. 文件与报文\",\"link\":\"/algorithm/RTKLIB-Manual-CN/08-appendixD\"},{\"text\":\"附录E. 模型与算法\",\"collapsed\":true,\"items\":[{\"text\":\"常用符号\",\"link\":\"/algorithm/RTKLIB-Manual-CN/09-appendixE-E.0\"},{\"text\":\"E.1 时间系统\",\"link\":\"/algorithm/RTKLIB-Manual-CN/09-appendixE-E.1\"},{\"text\":\"E.2 坐标系统\",\"link\":\"/algorithm/RTKLIB-Manual-CN/09-appendixE-E.2\"},{\"text\":\"E.3 信号测量模型\",\"link\":\"/algorithm/RTKLIB-Manual-CN/09-appendixE-E.3\"},{\"text\":\"E.4 卫星星历与钟差\",\"link\":\"/algorithm/RTKLIB-Manual-CN/09-appendixE-E.4\"},{\"text\":\"E.5 大气模型\",\"link\":\"/algorithm/RTKLIB-Manual-CN/09-appendixE-E.5\"},{\"text\":\"E.6 单点定位\",\"link\":\"/algorithm/RTKLIB-Manual-CN/09-appendixE-E.6\"},{\"text\":\"E.7 相对定位\",\"link\":\"/algorithm/RTKLIB-Manual-CN/09-appendixE-E.7\"},{\"text\":\"E.8 精密单点定位\",\"link\":\"/algorithm/RTKLIB-Manual-CN/09-appendixE-E.8\"}]},{\"text\":\"附录F. 配置文件\",\"link\":\"/algorithm/RTKLIB-Manual-CN/10-appendixF\"},{\"text\":\"附录G. GNSS信号\",\"link\":\"/algorithm/RTKLIB-Manual-CN/11-appendixG\"},{\"text\":\"附录H. 常见问题\",\"link\":\"/algorithm/RTKLIB-Manual-CN/12-appendixH\"},{\"text\":\"参考文献\",\"link\":\"/algorithm/RTKLIB-Manual-CN/13-reference\"}],\"/algorithm/RTKLIB-Source-Notes/\":[{\"text\":\"RTKLIB-Source-Notes\",\"link\":\"\"},{\"text\":\"1. 初识RTKLIB\",\"link\":\"/algorithm/RTKLIB-Source-Notes/01-overview\",\"collapsed\":true,\"items\":[{\"text\":\"1.1 简介\",\"link\":\"/algorithm/RTKLIB-Source-Notes/01-overview-1.1\"},{\"text\":\"1.2 基本使用\",\"link\":\"/algorithm/RTKLIB-Source-Notes/01-overview-1.2\"},{\"text\":\"1.3 RTKLIB手册\",\"link\":\"/algorithm/RTKLIB-Source-Notes/01-overview-1.3\"},{\"text\":\"1.4 核心代码库\",\"link\":\"/algorithm/RTKLIB-Source-Notes/01-overview-1.4\"},{\"text\":\"1.5 延伸项目\",\"link\":\"/algorithm/RTKLIB-Source-Notes/01-overview-1.5\"},{\"text\":\"1.6 学习建议\",\"link\":\"/algorithm/RTKLIB-Source-Notes/01-overview-1.6\"}]},{\"text\":\"2. 实时定位程序\",\"link\":\"/algorithm/RTKLIB-Source-Notes/02-rtknavi-rtkrcv\"},{\"text\":\"3. 后处理程序\",\"link\":\"/algorithm/RTKLIB-Source-Notes/03-rtkpos-rnx2rtkp-rtkplot-rtkget\"},{\"text\":\"4. 基础工具库\",\"link\":\"/algorithm/RTKLIB-Source-Notes/04-rtkcmn\"},{\"text\":\"5. 原始观测数据\",\"link\":\"/algorithm/RTKLIB-Source-Notes/05-obs\"},{\"text\":\"6. 卫星轨道计算\",\"link\":\"/algorithm/RTKLIB-Source-Notes/06-eph\"},{\"text\":\"7. 观测值改正\",\"link\":\"/algorithm/RTKLIB-Source-Notes/07-obs-correction\"},{\"text\":\"8. 伪距单点定位\",\"collapsed\":true,\"link\":\"/algorithm/RTKLIB-Source-Notes/08-spp\",\"items\":[{\"text\":\"8.1 pntpos()：算法入口\",\"link\":\"/algorithm/RTKLIB-Source-Notes/08-spp-8.1\"},{\"text\":\"8.2 estpos()：伪距定位\",\"link\":\"/algorithm/RTKLIB-Source-Notes/08-spp-8.2\"},{\"text\":\"8.3 estvel()：多普勒定速\",\"link\":\"/algorithm/RTKLIB-Source-Notes/08-spp-8.3\"},{\"text\":\"8.4 raim_fde()：正直性检测\",\"link\":\"/algorithm/RTKLIB-Source-Notes/08-spp-8.4\"}]},{\"text\":\"9. 相对定位\",\"collapsed\":true,\"link\":\"/algorithm/RTKLIB-Source-Notes/09-rtk\",\"items\":[{\"text\":\"9.1 主要数据类型\",\"link\":\"/algorithm/RTKLIB-Source-Notes/09-rtk-9.1\"},{\"text\":\"9.2 rtkpos(): 算法入口\",\"link\":\"/algorithm/RTKLIB-Source-Notes/09-rtk-9.2\"},{\"text\":\"9.3 udstate(): 时间更新\",\"link\":\"/algorithm/RTKLIB-Source-Notes/09-rtk-9.3\"},{\"text\":\"9.4 *dres(): 观测方程的构建\",\"link\":\"/algorithm/RTKLIB-Source-Notes/09-rtk-9.4\"},{\"text\":\"9.5 filter(): 量测更新\",\"link\":\"/algorithm/RTKLIB-Source-Notes/09-rtk-9.5\"},{\"text\":\"9.6 *amb(): 模糊度固定\",\"link\":\"/algorithm/RTKLIB-Source-Notes/09-rtk-9.6\"},{\"text\":\"9.7 detslp*(): 周跳探测\",\"link\":\"/algorithm/RTKLIB-Source-Notes/09-rtk-9.7\"}]},{\"text\":\"10. 精密单点定位\",\"link\":\"/algorithm/RTKLIB-Source-Notes/10-ppp\"},{\"text\":\"11. RTKLIB工程优化\",\"link\":\"/algorithm/RTKLIB-Source-Notes/11-optimization\"},{\"text\":\"附录A. 延伸阅读\",\"link\":\"/algorithm/RTKLIB-Source-Notes/A-appendixA\"},{\"text\":\"附录B. 常见问题\",\"link\":\"/algorithm/RTKLIB-Source-Notes/B-appendixB\"},{\"text\":\"附录C. 配置参数解析\",\"collapsed\":true,\"link\":\"/algorithm/RTKLIB-Source-Notes/C-appendixC\",\"items\":[{\"text\":\"C.1 Setting1\",\"link\":\"/algorithm/RTKLIB-Source-Notes/C-appendixC-C.1\"},{\"text\":\"C.2 Setting2\",\"link\":\"/algorithm/RTKLIB-Source-Notes/C-appendixC-C.2\"},{\"text\":\"C.3 Statistics\",\"link\":\"/algorithm/RTKLIB-Source-Notes/C-appendixC-C.3\"}]},{\"text\":\"参考资料\",\"link\":\"/algorithm/RTKLIB-Source-Notes/Z-reference\"}],\"/hide/tools/vitepress/\":[{\"text\":\"Tutorials\",\"link\":\"/hide/tools/vitepress/01-tutorials\"},{\"text\":\"Issues\",\"link\":\"/hide/tools/vitepress/02-issues\"}],\"/hide/tools/git/\":[{\"text\":\"Tutorials\",\"link\":\"/hide/tools/git/01-tutorials\"}],\"/hide/coding/cpp-style/\":[{\"text\":\"CPP-Style\",\"link\":\"\"},{\"text\":\"1. Google\",\"link\":\"/hide/coding/cpp-style/01-google\"},{\"text\":\"2. Huawei\",\"link\":\"/hide/coding/cpp-style/02-huawei\"},{\"text\":\"3. MySelf\",\"link\":\"/hide/coding/cpp-style/03-myself\"}],\"/hide/examples/\":[{\"text\":\"Examples\",\"items\":[{\"text\":\"Markdown Examples\",\"link\":\"/hide/examples/markdown-examples\"},{\"text\":\"Runtime API Examples\",\"link\":\"/hide/examples/api-examples\"}]}]},\"outline\":{\"label\":\"目录\",\"level\":[2,3]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/salmoshu\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>